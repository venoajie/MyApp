from utilities import string_modification, number_modification, pickling, system_tools
from configuration import config
import asyncio
import os
import sqlite3
import time
import ast
from db_management import sqlite_management
#standardize database file location
import json, orjson

path = os.getcwd()
db_name = 'multistrike_oi.db'

#
# from loguru import logger as log
my_trades_open = [
    {'trade_seq': 122628217, 'trade_id': 'ETH-166736294', 'timestamp': 1681359527286, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1940.7, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32845591518', 'mmp': False, 'matching_id': None, 'mark_price': 1940.67, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681359527286', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1940.06, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': False, 'amount': 70.0}, {'trade_seq': 122668128, 'trade_id': 'ETH-166788115', 'timestamp': 1681379087335, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1982.85, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850806120', 'mmp': False, 'matching_id': None, 'mark_price': 1982.48, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379086467', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.27, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 2.0}, {'trade_seq': 122668132, 'trade_id': 'ETH-166788122', 'timestamp': 1681379091803, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1982.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850806898', 'mmp': False, 'matching_id': None, 'mark_price': 1982.71, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379088168', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.46, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 2.0}, {'trade_seq': 122668143, 'trade_id': 'ETH-166788137', 'timestamp': 1681379092904, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1982.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850808573', 'mmp': False, 'matching_id': None, 'mark_price': 1982.75, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379092455', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.49, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668165, 'trade_id': 'ETH-166788161', 'timestamp': 1681379098189, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1983.05, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850808879', 'mmp': False, 'matching_id': None, 'mark_price': 1982.92, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379093097', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.56, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668171, 'trade_id': 'ETH-166788168', 'timestamp': 1681379102096, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1983.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850810139', 'mmp': False, 'matching_id': None, 'mark_price': 1983.03, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379098646', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.63, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668175, 'trade_id': 'ETH-166788176', 'timestamp': 1681379105603, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1983.5, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850811403', 'mmp': False, 'matching_id': None, 'mark_price': 1983.65, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379102577', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1982.16, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668454, 'trade_id': 'ETH-166788502', 'timestamp': 1681379208314, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1986.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850838999', 'mmp': False, 'matching_id': None, 'mark_price': 1986.23, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379202187', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1984.66, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668473, 'trade_id': 'ETH-166788526', 'timestamp': 1681379215498, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1986.4, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850839959', 'mmp': False, 'matching_id': None, 'mark_price': 1986.66, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379208787', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1985.01, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668530, 'trade_id': 'ETH-166788584', 'timestamp': 1681379222177, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1987.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850842190', 'mmp': False, 'matching_id': None, 'mark_price': 1987.23, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379215980', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1985.56, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122669374, 'trade_id': 'ETH-166789594', 'timestamp': 1681379438779, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1986.6, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850907737', 'mmp': False, 'matching_id': None, 'mark_price': 1986.88, 'liquidity': 'M', 'label': 'hedgingSpot-open-1681379437841', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1985.25, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668129, 'trade_id': 'ETH-166788119', 'timestamp': 1681379091803, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1982.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850806806', 'mmp': False, 'matching_id': None, 'mark_price': 1982.71, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681379087881', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.46, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122668130, 'trade_id': 'ETH-166788120', 'timestamp': 1681379091803, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1982.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32850806885', 'mmp': False, 'matching_id': None, 'mark_price': 1982.71, 'liquidity': 'M', 'label': 'every4hoursShort-open-1681379088074', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1981.46, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122674714, 'trade_id': 'ETH-166796420', 'timestamp': 1681382745707, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1991.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32851707794', 'mmp': False, 'matching_id': None, 'mark_price': 1991.35, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681382741149', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1989.99, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122672670, 'trade_id': 'ETH-166793894', 'timestamp': 1681381940152, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1988.05, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32851484653', 'mmp': False, 'matching_id': None, 'mark_price': 1988.04, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681381940152', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1986.74, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122677947, 'trade_id': 'ETH-166800562', 'timestamp': 1681385893041, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1988.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32852419907', 'mmp': False, 'matching_id': None, 'mark_price': 1989.03, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681385893041', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1988.11, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122721832, 'trade_id': 'ETH-166854545', 'timestamp': 1681412801775, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2016.6, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32859447160', 'mmp': False, 'matching_id': None, 'mark_price': 2016.57, 'liquidity': 'M', 'label': 'every4hoursShort-open-1681412800246', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2015.58, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 3.0}, {'trade_seq': 122722014, 'trade_id': 'ETH-166854784', 'timestamp': 1681412888940, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2017.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32859465098', 'mmp': False, 'matching_id': None, 'mark_price': 2017.87, 'liquidity': 'M', 'label': 'every4hoursShort-open-1681379092355', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2016.83, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122725688, 'trade_id': 'ETH-166859630', 'timestamp': 1681416368448, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2009.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32860223240', 'mmp': False, 'matching_id': None, 'mark_price': 2009.03, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681416357235', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2007.69, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122727064, 'trade_id': 'ETH-166861465', 'timestamp': 1681417521367, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2010.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32860515335', 'mmp': False, 'matching_id': None, 'mark_price': 2010.17, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681416449049', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2009.53, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122728606, 'trade_id': 'ETH-166863297', 'timestamp': 1681420030256, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2008.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32860936117', 'mmp': False, 'matching_id': None, 'mark_price': 2008.88, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681420027795', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2008.5, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122730549, 'trade_id': 'ETH-166865803', 'timestamp': 1681423735982, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2011.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32861379909', 'mmp': False, 'matching_id': None, 'mark_price': 2011.04, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681423656141', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2010.72, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122730852, 'trade_id': 'ETH-166866220', 'timestamp': 1681424637976, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2014.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32861493560', 'mmp': False, 'matching_id': None, 'mark_price': 2014.67, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681421211152', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2013.98, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122732683, 'trade_id': 'ETH-166868485', 'timestamp': 1681427377566, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2007.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32861910604', 'mmp': False, 'matching_id': None, 'mark_price': 2007.77, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681427349827', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2007.35, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122732684, 'trade_id': 'ETH-166868486', 'timestamp': 1681427377566, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2007.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32861910624', 'mmp': False, 'matching_id': None, 'mark_price': 2007.77, 'liquidity': 'M', 'label': 'every4hoursShort-open-1681427349892', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2007.35, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 3.0}, {'trade_seq': 122734504, 'trade_id': 'ETH-166870701', 'timestamp': 1681431075533, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2012.1, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32862323687', 'mmp': False, 'matching_id': None, 'mark_price': 2012.03, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681431014522', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2011.79, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122734729, 'trade_id': 'ETH-166870986', 'timestamp': 1681431388179, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2016.3, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32862366828', 'mmp': False, 'matching_id': None, 'mark_price': 2016.42, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681428238651', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2016.04, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122738307, 'trade_id': 'ETH-166875867', 'timestamp': 1681432586128, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2030.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32862812707', 'mmp': False, 'matching_id': None, 'mark_price': 2031.13, 'liquidity': 'M', 'label': 'every4hoursLong-closed-1681427299333', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2029.93, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 3.0}, {'trade_seq': 122766994, 'trade_id': 'ETH-166911883', 'timestamp': 1681434735831, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2106.65, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32864318805', 'mmp': False, 'matching_id': None, 'mark_price': 2106.46, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681434731797', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2104.73, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122768197, 'trade_id': 'ETH-166913326', 'timestamp': 1681435014348, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2109.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32864428546', 'mmp': False, 'matching_id': None, 'mark_price': 2109.04, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681421211152', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2107.42, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122768198, 'trade_id': 'ETH-166913327', 'timestamp': 1681435014348, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2109.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32864428578', 'mmp': False, 'matching_id': None, 'mark_price': 2109.04, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681428238651', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2107.42, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122781231, 'trade_id': 'ETH-166929974', 'timestamp': 1681438616112, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.486e-05, 'price': 2122.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32865789967', 'mmp': False, 'matching_id': None, 'mark_price': 2122.37, 'liquidity': 'M', 'label': 'every1hoursLong-open-1681438615254', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2121.09, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122783506, 'trade_id': 'ETH-166933116', 'timestamp': 1681440165206, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.345e-05, 'price': 2115.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866112673', 'mmp': False, 'matching_id': None, 'mark_price': 2115.35, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2114.75, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122784124, 'trade_id': 'ETH-166933990', 'timestamp': 1681440354086, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.219e-05, 'price': 2110.25, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866193709', 'mmp': False, 'matching_id': None, 'mark_price': 2110.51, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2109.82, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122784170, 'trade_id': 'ETH-166934044', 'timestamp': 1681440369469, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.217e-05, 'price': 2110.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866199548', 'mmp': False, 'matching_id': None, 'mark_price': 2110.25, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2109.53, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122784178, 'trade_id': 'ETH-166934052', 'timestamp': 1681440370496, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.216e-05, 'price': 2110.1, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866206665', 'mmp': False, 'matching_id': None, 'mark_price': 2110.02, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2109.31, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122784588, 'trade_id': 'ETH-166934622', 'timestamp': 1681440408643, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.123e-05, 'price': 2106.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866230210', 'mmp': False, 'matching_id': None, 'mark_price': 2106.08, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2105.23, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785129, 'trade_id': 'ETH-166935376', 'timestamp': 1681440497426, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.137e-05, 'price': 2106.6, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866283153', 'mmp': False, 'matching_id': None, 'mark_price': 2106.77, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2105.46, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785144, 'trade_id': 'ETH-166935391', 'timestamp': 1681440498810, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.128e-05, 'price': 2106.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866284122', 'mmp': False, 'matching_id': None, 'mark_price': 2106.25, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2104.95, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785146, 'trade_id': 'ETH-166935393', 'timestamp': 1681440500438, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.128e-05, 'price': 2106.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866284481', 'mmp': False, 'matching_id': None, 'mark_price': 2106.58, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2105.29, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785148, 'trade_id': 'ETH-166935395', 'timestamp': 1681440501629, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.127e-05, 'price': 2106.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866284863', 'mmp': False, 'matching_id': None, 'mark_price': 2106.43, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2105.16, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785174, 'trade_id': 'ETH-166935421', 'timestamp': 1681440506903, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.127e-05, 'price': 2106.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866285290', 'mmp': False, 'matching_id': None, 'mark_price': 2106.74, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2105.55, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785546, 'trade_id': 'ETH-166935896', 'timestamp': 1681440601235, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.168e-05, 'price': 2108.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866316523', 'mmp': False, 'matching_id': None, 'mark_price': 2108.25, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2107.75, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122785549, 'trade_id': 'ETH-166935901', 'timestamp': 1681440604114, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.165e-05, 'price': 2107.85, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866317834', 'mmp': False, 'matching_id': None, 'mark_price': 2107.89, 'liquidity': 'M', 'label': 'every1hoursShort-closed-1681438356549', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2107.44, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122787476, 'trade_id': 'ETH-166938468', 'timestamp': 1681441819134, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2103.25, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32866559801', 'mmp': False, 'matching_id': None, 'mark_price': 2103.11, 'liquidity': 'M', 'label': 'every4hoursShort-open-1681441810315', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2102.71, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 3.0}, {'trade_seq': 122792041, 'trade_id': 'ETH-166945630', 'timestamp': 1681446613430, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2114.9, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32867310761', 'mmp': False, 'matching_id': None, 'mark_price': 2115.15, 'liquidity': 'M', 'label': 'every1hoursShort-open-1681446601023', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2114.54, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122792215, 'trade_id': 'ETH-166945835', 'timestamp': 1681446774932, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -3.192e-05, 'price': 2114.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32867310760', 'mmp': False, 'matching_id': None, 'mark_price': 2115.33, 'liquidity': 'M', 'label': 'every1hoursLong-open-1681446600972', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2114.88, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, {'trade_seq': 122792853, 'trade_id': 'ETH-166946637', 'timestamp': 1681447420920, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2116.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32867480566', 'mmp': False, 'matching_id': None, 'mark_price': 2117.23, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681421211152', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2117.24, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122792854, 'trade_id': 'ETH-166946638', 'timestamp': 1681447420920, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 2116.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32867480579', 'mmp': False, 'matching_id': None, 'mark_price': 2117.23, 'liquidity': 'M', 'label': 'every1hoursLong-closed-1681428238651', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2117.24, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, {'trade_seq': 122793232, 'trade_id': 'ETH-166947107', 'timestamp': 1681447691857, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -9.23e-05, 'price': 2116.85, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32867483737', 'mmp': False, 'matching_id': None, 'mark_price': 2117.09, 'liquidity': 'M', 'label': 'every4hoursLong-open-1681447421981', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 2117.01, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 3.0}
                  ]

my_trades_path = system_tools.provide_path_for_file("myTrades", "eth", "open")

my_trades_path_open_recovery = system_tools.provide_path_for_file(
    "myTrades", "eth", "open-recovery-point"
)
my_trades  = pickling.read_data(my_trades_path_open_recovery)

net = number_modification.net_position(my_trades_open)
print (net)


async  def main() -> list:
    """ """
    await sqlite_management.insert_tables ('my_trades_all_json',
                                 my_trades_open)    
    await sqlite_management.insert_tables ('my_trades_all',
                                 my_trades_open)

    
if __name__ == "__main__":
        
    try:
        pickling.replace_data(my_trades_path, my_trades_open, True)
        pickling.replace_data(my_trades_path_open_recovery, my_trades_open, True)
        asyncio.get_event_loop().run_until_complete(main())

    except Exception as error:
        print (error)

