from portfolio.deribit import myTrades_management

exc = [
  {'trade_seq': 12034252, 'trade_id': 'ETH-16819839', 'timestamp': 1672752015157, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1215.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3200217417', 'mmp': False, 'matching_id': None, 'mark_price': 1215.45, 'liquidity': 'M', 'label': 'hedging spot-open-1672751989009', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1215.91, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0},
  {'trade_seq': 12035260, 'trade_id': 'ETH-16823866', 'timestamp': 1672791529428, 'tick_direction': 2, 'state': 'open', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1214.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201365507', 'mmp': False, 'matching_id': None, 'mark_price': 1214.23, 'liquidity': 'M', 'label': 'hedging spot-open-1672791515955', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1214.07, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 27.0}, 
  {'trade_seq': 12035261, 'trade_id': 'ETH-16823867', 'timestamp': 1672791590155, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1214.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201365507', 'mmp': False, 'matching_id': None, 'mark_price': 1214.28, 'liquidity': 'M', 'label': 'hedging spot-open-1672791515955', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1214.09, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 9.0},
  {'trade_seq': 12036073, 'trade_id': 'ETH-16827730', 'timestamp': 1672805771579, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1251.8, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201781586', 'mmp': False, 'matching_id': None, 'mark_price': 1251.91, 'liquidity': 'M', 'label': 'hedging spot-open-1672805764099', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1251.79, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0}, 
  {'trade_seq': 12036076, 'trade_id': 'ETH-16827784', 'timestamp': 1672806281693, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1249.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201795065', 'mmp': False, 'matching_id': None, 'mark_price': 1249.96, 'liquidity': 'M', 'label': 'hedging spot-open-1672806259339', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1250.06, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 15.0}, 
  {'trade_seq': 12036081, 'trade_id': 'ETH-16827806', 'timestamp': 1672806356704, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -0.00050342, 'price': 1251.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201797356', 'mmp': False, 'matching_id': None, 'mark_price': 1251.17, 'liquidity': 'M', 'label': 'hedging spot-closed-1672805764099', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1251.05, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 36.0}, 
  {'trade_seq': 12036082, 'trade_id': 'ETH-16827809', 'timestamp': 1672806681759, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1250.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201805962', 'mmp': False, 'matching_id': None, 'mark_price': 1250.22, 'liquidity': 'M', 'label': 'hedging spot-open-1672806664020', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1250.12, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0}, 
  
  {'trade_seq': 12036100, 'trade_id': 'ETH-16827855', 'timestamp': 1672806981862, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1252.65, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201814252', 'mmp': False, 'matching_id': None, 'mark_price': 1252.68, 'liquidity': 'M', 'label': 'hedging spot-open-1672806972394', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1252.5, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, 
  {'trade_seq': 12036114, 'trade_id': 'ETH-16827880', 'timestamp': 1672807096894, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -1.06e-05, 'price': 1252.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201816663', 'mmp': False, 'matching_id': None, 'mark_price': 1252.05, 'liquidity': 'M', 'label': 'hedging spot-closed-1672806972394', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1252.01, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}, 
  {'trade_seq': 12036116, 'trade_id': 'ETH-16827902', 'timestamp': 1672807211887, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -1.063e-05, 'price': 1252.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201820395', 'mmp': False, 'matching_id': None, 'mark_price': 1252.02, 'liquidity': 'M', 'label': 'hedging spot-closed-1672806972394', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1252.15, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 1.0}]

db = [
  {'trade_seq': 12034252, 'trade_id': 'ETH-16819839', 'timestamp': 1672752015157, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1215.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3200217417', 'mmp': False, 'matching_id': None, 'mark_price': 1215.45, 'liquidity': 'M', 'label': 'hedging spot-open-1672751989009', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1215.91, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0}, 
  {'trade_seq': 12035260, 'trade_id': 'ETH-16823866', 'timestamp': 1672791529428, 'tick_direction': 2, 'state': 'open', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1214.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201365507', 'mmp': False, 'matching_id': None, 'mark_price': 1214.23, 'liquidity': 'M', 'label': 'hedging spot-open-1672791515955', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1214.07, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 27.0},
  {'trade_seq': 12035261, 'trade_id': 'ETH-16823867', 'timestamp': 1672791590155, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1214.35, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201365507', 'mmp': False, 'matching_id': None, 'mark_price': 1214.28, 'liquidity': 'M', 'label': 'hedging spot-open-1672791515955', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1214.09, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 9.0}, 
  {'trade_seq': 12036073, 'trade_id': 'ETH-16827730', 'timestamp': 1672805771579, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1251.8, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201781586', 'mmp': False, 'matching_id': None, 'mark_price': 1251.91, 'liquidity': 'M', 'label': 'hedging spot-open-1672805764099', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1251.79, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0}, 
  {'trade_seq': 12036076, 'trade_id': 'ETH-16827784', 'timestamp': 1672806281693, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1249.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201795065', 'mmp': False, 'matching_id': None, 'mark_price': 1249.96, 'liquidity': 'M', 'label': 'hedging spot-open-1672806259339', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1250.06, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 15.0}, 
  {'trade_seq': 12036081, 'trade_id': 'ETH-16827806', 'timestamp': 1672806356704, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': -0.00050342, 'price': 1251.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201797356', 'mmp': False, 'matching_id': None, 'mark_price': 1251.17, 'liquidity': 'M', 'label': 'hedging spot-closed-1672805764099', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1251.05, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 36.0}, 
  {'trade_seq': 12036082, 'trade_id': 'ETH-16827809', 'timestamp': 1672806681759, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1250.2, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-3201805962', 'mmp': False, 'matching_id': None, 'mark_price': 1250.22, 'liquidity': 'M', 'label': 'hedging spot-open-1672806664020', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1250.12, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 36.0}]

trades = myTrades_management.MyTrades (exc)
trades.distribute_trade_transaction('eth')