from utilities import string_modification, number_modification, pickling, system_tools
from configuration import config

# from loguru import logger as log
my_trades_open =  [
    {'trade_seq': 119459281, 'trade_id': 'ETH-162634254', 'timestamp': 1678610180143, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1473.05, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32205761779', 'mmp': False, 'matching_id': None, 'mark_price': 1472.79, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678610144572', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1474.68, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 78.0},
    {'trade_seq': 120041131, 'trade_id': 'ETH-163410869', 'timestamp': 1678887889760, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1684.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32301363447', 'mmp': False, 'matching_id': None, 'mark_price': 1684.77, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678887846503', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1683.48, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 79.0}, 
    {'trade_seq': 120015629, 'trade_id': 'ETH-163380400', 'timestamp': 1678880514061, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1675.4, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32297101093', 'mmp': False, 'matching_id': None, 'mark_price': 1675.76, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678880511772', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1676.02, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 78.0}, 
    {'trade_seq': 119773081, 'trade_id': 'ETH-163068627', 'timestamp': 1678755677524, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1671.55, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32252020677', 'mmp': False, 'matching_id': None, 'mark_price': 1671.66, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678755675478', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1673.29, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 68.0},
    {'trade_seq': 119653801, 'trade_id': 'ETH-162909430', 'timestamp': 1678706775993, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1583.75, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32231983208', 'mmp': False, 'matching_id': None, 'mark_price': 1583.81, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678706775367', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1583.99, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 5.0}, 
    {'trade_seq': 119665688, 'trade_id': 'ETH-162925875', 'timestamp': 1678713118256, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1598.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32234303212', 'mmp': False, 'matching_id': None, 'mark_price': 1597.73, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678713106585', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1597.86, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 1.0}, 
    {'trade_seq': 119736857, 'trade_id': 'ETH-163020718', 'timestamp': 1678727097665, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1666.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32243915623', 'mmp': False, 'matching_id': None, 'mark_price': 1666.07, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678727089260', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1666.08, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 4.0}, 
    {'trade_seq': 119736858, 'trade_id': 'ETH-163020719', 'timestamp': 1678727097665, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1666.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32243915636', 'mmp': False, 'matching_id': None, 'mark_price': 1666.07, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678727089307', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1666.08, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 4.0},
    {'trade_seq': 119736859, 'trade_id': 'ETH-163020720', 'timestamp': 1678727097665, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1666.15, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32243915644', 'mmp': False, 'matching_id': None, 'mark_price': 1666.07, 'liquidity': 'M', 'label': 'hedgingSpot-open-1678727089354', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1666.08, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 4.0},
    {'trade_seq': 119946512, 'trade_id': 'ETH-163294790', 'timestamp': 1678828105145, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1679.8, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32281785727', 'mmp': False, 'matching_id': None, 'mark_price': 1679.01, 'liquidity': 'M', 'label': 'supplyDemandShort60-open-1678828104726', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1677.09, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 10.0}, 
    {'trade_seq': 120398030, 'trade_id': 'ETH-163872455', 'timestamp': 1679139144231, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1817.85, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32386982354', 'mmp': False, 'matching_id': None, 'mark_price': 1818.15, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679139121800', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1817.4, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0},
    {'trade_seq': 120460945, 'trade_id': 'ETH-163959265', 'timestamp': 1679205009236, 'tick_direction': 0, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150899', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971378', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460946, 'trade_id': 'ETH-163959266', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150901', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971425', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460947, 'trade_id': 'ETH-163959267', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150911', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971472', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460948, 'trade_id': 'ETH-163959268', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150922', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971520', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460949, 'trade_id': 'ETH-163959269', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150928', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971568', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460950, 'trade_id': 'ETH-163959270', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150932', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971613', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460951, 'trade_id': 'ETH-163959271', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150944', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971663', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120460952, 'trade_id': 'ETH-163959272', 'timestamp': 1679205009236, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1783.95, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32404150950', 'mmp': False, 'matching_id': None, 'mark_price': 1784.05, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679204971720', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1782.8, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0},
    {'trade_seq': 120473261, 'trade_id': 'ETH-163975417', 'timestamp': 1679218646776, 'tick_direction': 1, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.0, 'price': 1780.65, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32406588944', 'mmp': False, 'matching_id': None, 'mark_price': 1780.49, 'liquidity': 'M', 'label': 'hedgingSpot-open-1679218645798', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1779.95, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'sell', 'api': True, 'amount': 7.0}, 
    {'trade_seq': 120555885, 'trade_id': 'ETH-164084644', 'timestamp': 1679274181564, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 5.156e-05, 'price': 1770.0, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32424303227', 'mmp': False, 'matching_id': None, 'mark_price': 1770.33, 'liquidity': 'M', 'label': 'supplyDemandLongA-open-1679271429967', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1770.83, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 17.0}, {'trade_seq': 120128991, 'trade_id': 'ETH-163514950', 'timestamp': 1678929453460, 'tick_direction': 3, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.00022816, 'price': 1638.3, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32319663903', 'mmp': False, 'matching_id': None, 'mark_price': 1638.47, 'liquidity': 'M', 'label': 'supplyDemandLong60B-open-1678929435849', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1638.91, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 11.0}, {'trade_seq': 120128990, 'trade_id': 'ETH-163514949', 'timestamp': 1678929453460, 'tick_direction': 2, 'state': 'filled', 'self_trade': False, 'risk_reducing': False, 'reduce_only': False, 'profit_loss': 0.00022816, 'price': 1638.3, 'post_only': True, 'order_type': 'limit', 'order_id': 'ETH-32319663846', 'mmp': False, 'matching_id': None, 'mark_price': 1638.47, 'liquidity': 'M', 'label': 'supplyDemandLong60A-open-1678929435708', 'instrument_name': 'ETH-PERPETUAL', 'index_price': 1638.91, 'fee_currency': 'ETH', 'fee': 0.0, 'direction': 'buy', 'api': True, 'amount': 11.0}]

my_trades_path = system_tools.provide_path_for_file("myTrades", "eth", "open")
pickling.replace_data(my_trades_path, my_trades_open, True)


my_trades_path_open_recovery = system_tools.provide_path_for_file(
    "myTrades", "eth", "open-recovery-point"
)
my_trades  = pickling.read_data(my_trades_path_open_recovery)
print (my_trades)

net = number_modification.net_position(my_trades_open)